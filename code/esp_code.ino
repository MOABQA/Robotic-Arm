#include <WiFi.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
#include <Wire.h>
#include <U8g2lib.h>
#include <WiFiUdp.h>
#include <ESP32Servo.h>

// Wi-Fi credentials
const char* ssid = "ssid";
const char* password = "password";

// UDP setup
WiFiUDP udp;
const int port = 8080;
char incomingPacket[255];

#define SCREEN_I2C_ADDR 0x3C // or 0x3C
#define SCREEN_WIDTH 128     // OLED display width, in pixels
#define SCREEN_HEIGHT 64     // OLED display height, in pixels
#define OLED_RST_PIN -1      // Reset pin (-1 if not available)

Adafruit_SSD1306 display(128, 64, &Wire, OLED_RST_PIN);

// Pin definitions for buttons
#define BUTTON_UP 14
#define BUTTON_DOWN 12
#define BUTTON_SELECT 2
#define BUTTON_BACK 13 // New back button
const byte PROGMEM frames[][288] = {
 {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,248,1,193,192,0,0,120,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,248,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,29,128,0,0,0,0,28,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,248,1,193,192,0,0,120,0,192,224,0,0,124,0,192,96,0,0,127,255,224,63,255,224,127,255,224,31,255,252,127,252,0,0,0,14,63,252,0,0,0,7,63,252,0,0,0,3,63,252,0,0,0,3,63,252,0,0,0,7,127,252,0,0,0,14,127,255,224,31,255,252,127,255,224,63,255,240,124,0,192,96,0,0,120,0,192,224,0,0,248,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,28,192,0,0,0,0,29,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,224,0,14,63,255,255,224,0,7,63,255,255,224,0,3,63,255,255,224,0,3,63,255,255,224,0,7,127,255,255,224,0,14,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,248,14,63,255,255,255,248,7,63,255,255,255,248,3,63,255,255,255,248,3,63,255,255,255,248,7,127,255,255,255,248,14,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,206,63,255,255,255,255,199,63,255,255,255,255,195,63,255,255,255,255,195,63,255,255,255,255,199,127,255,255,255,255,238,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,248,1,255,192,0,0,120,0,255,224,0,0,124,0,255,224,0,0,127,255,255,255,255,224,127,255,255,255,255,252,127,255,255,255,255,254,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,63,255,255,255,255,255,127,255,255,255,255,254,127,255,255,255,255,252,127,255,255,255,255,240,124,0,255,224,0,0,120,0,255,224,0,0,248,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,216,1,255,192,0,0,88,0,255,224,0,0,108,0,255,224,0,0,111,255,255,255,255,224,103,255,255,255,255,252,99,255,255,255,255,254,51,255,255,255,255,255,51,255,255,255,255,255,51,255,255,255,255,255,51,255,255,255,255,255,99,255,255,255,255,254,103,255,255,255,255,252,111,255,255,255,255,240,108,0,255,224,0,0,120,0,255,224,0,0,216,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,31,128,0,0,0,0,31,192,0,0,0,0,15,224,0,0,0,0,15,240,0,0,0,0,7,240,0,0,0,0,7,248,0,0,0,0,7,252,0,0,0,0,3,254,0,0,0,0,3,255,0,0,0,240,1,255,0,0,0,240,1,255,128,0,0,216,1,255,192,0,0,88,0,255,224,0,0,108,0,255,224,0,0,111,255,255,255,255,224,103,255,255,255,255,252,96,15,255,255,255,254,48,15,255,255,255,255,48,15,255,255,255,255,48,15,255,255,255,255,48,15,255,255,255,255,96,15,255,255,255,254,103,255,255,255,255,252,111,255,255,255,255,240,108,0,255,224,0,0,120,0,255,224,0,0,216,1,255,192,0,0,240,1,255,128,0,0,240,1,255,0,0,0,96,3,255,0,0,0,0,3,254,0,0,0,0,7,252,0,0,0,0,7,248,0,0,0,0,7,240,0,0,0,0,15,240,0,0,0,0,15,224,0,0,0,0,31,192,0,0,0,0,31,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,135,0,0,0,240,1,135,128,0,0,216,1,199,192,0,0,88,0,199,224,0,0,108,0,199,224,0,0,111,255,231,255,255,224,103,255,231,255,255,252,96,0,7,255,255,254,48,0,7,255,255,255,48,0,7,255,255,255,48,0,7,255,255,255,48,0,7,255,255,255,96,0,7,255,255,254,103,255,231,255,255,252,111,255,231,255,255,240,108,0,199,224,0,0,120,0,199,224,0,0,216,1,199,192,0,0,240,1,135,128,0,0,240,1,135,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,31,254,48,0,0,0,31,255,48,0,0,0,31,255,48,0,0,0,31,255,48,0,0,0,31,255,96,0,0,0,31,254,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
  {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,30,0,0,0,0,0,31,0,0,0,0,0,25,128,0,0,0,0,24,192,0,0,0,0,12,224,0,0,0,0,12,112,0,0,0,0,6,48,0,0,0,0,6,24,0,0,0,0,6,12,0,0,0,0,3,14,0,0,0,0,3,7,0,0,0,240,1,131,0,0,0,240,1,129,128,0,0,216,1,193,192,0,0,88,0,192,224,0,0,108,0,192,96,0,0,111,255,224,63,255,224,103,255,224,31,255,252,96,0,0,0,0,14,48,0,0,0,0,7,48,0,0,0,0,3,48,0,0,0,0,3,48,0,0,0,0,7,96,0,0,0,0,14,103,255,224,31,255,252,111,255,224,63,255,240,108,0,192,96,0,0,120,0,192,224,0,0,216,1,193,192,0,0,240,1,129,128,0,0,240,1,131,0,0,0,96,3,7,0,0,0,0,3,14,0,0,0,0,6,12,0,0,0,0,6,24,0,0,0,0,6,48,0,0,0,0,12,112,0,0,0,0,12,224,0,0,0,0,24,192,0,0,0,0,25,128,0,0,0,0,31,0,0,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
};

const uint8_t aldo_the_apache_26pt[2338] U8G2_FONT_SECTION("aldo_the_apache_26pt") = 
  "[\0\4\4\5\5\3\6\6\30%\0\372\31\0\33\375\3,\6@\11\5 \6\0\20D\1!\15%"
  "\27<\341\7%\206\314o\37(\42\12J\65f\201\10\376\23\2#>\66\27\304o\20QBD\11\21"
  "%D\224\20QBc\11\15{`\342\301\203V\204\210\22\42J\210(!\242\204H=\60\361\300\304\3"
  "c\203\210\22\42J\210(!\242\204\210\22\42Jh\34\0$\35\255\327{\213$\241\7\77P\224a\301"
  "s\327\241\273\316\240\32m\36\374@\25IB\0%M\66\27\314\345d \224C\20\16!\62n\14\221"
  "a\203\210\14\33Dd\324(\42\203\206\21\31\63\216\310\230qh\6\42\31yd<\240\61\7\307\240\33"
  "\223l\320\230a\203\306\214\232f\320\260\61\203\304\215\231n\314\220\201)F\242\11z\4\0&\27tv"
  "\274\317\270\275{\360\277c\250\24\261q\362 \306\3\11\14\0'\10D\65\66\341\3\5(\23\310\267S"
  "\247\210\211\7\214\350\377\177\364 \304\21\63\5)\24\310\267S\241\214\221\23\17\2\321\377\377\350\1\13#"
  "e\0*\32\256\225\205\213(eB\210\10a\321\244\221\271c\251\210\220!\63.P \0+\17tv"
  "\274\317\270\275{\360\277\63n\337\1,\14E\225;\341\213!#\6\5\1-\10\207TM\341A\3."
  "\7\305\24<\341\3/\30\310\267Sk*a\242\346J\230\250\271\22\65\257D\315\225\60Q\263\2\60\25"
  ".\27\204g\11\213\7\37\4\322\377\217\36|\20\202\311\32\0\61\17)\27\134\307\310\211\7+\60\252\377"
  "\377\0\62\32-\27|G\311\212\7\17\332\250)X\235\261S\367\231\271\202\5\37\374\240\0\63\37.\27"
  "\214g\11\213\7\37\4\322\250du\347J\22=w\262\244\42\215\36|\20\202\311\32\0\64%\60\27\224"
  "q\64Y\243\7\261K\246\214D\251\22\245J\24*R\250H\231:)T\346\305\23\67-\313\326\11\0"
  "\65\33.\27\204\241E_\224\254\345\32&-\36\264\254R\221F\17\36\214h\302f\1\66\32-\27|"
  "G\311\212\7\17\332hX\341\203\37\250\321\233\7\17Z,Q\3\0\67!.\27\204a\15\223\26\17\36"
  "\14RT\260d\205%K\222\254\260d\205%\13\32,Y\320`\71\0\70\34.\27\214g\11\213\7\37"
  "\4\322G$\230\254b\361`\220\36=\370 \4\223\65\0\71\33-\27|G\311\212\7\17\332\350\315\203"
  "\37(,\250F\233\7\17Z,Q\3\0:\11\245\26<\341{\30|;\17%\227C\341{\30|\61"
  "d\304\240 \0<\35\361\366\233\37D\360\301eM\36\274\362\340\245\205I\27\276\261\341\213\15\27\37\17"
  "\42\0=\15P\365\234\341\7\343\341\350\301\7\3>#\361\366\233!<\10\361\0H\33>{\370b\303"
  "\207M\223\65y\322\344\301+\215\232%-\36@x\20\0\77\32-\27|A\315\22\26\17\36\204QS"
  "\260v\306lW\260\366\20\25\254#\0@\67\26\27\314\347\1\221\7%\36|\60X\253\7\202\36\214y"
  "@\344A\221\7EJ))\245\244\224\222RJJ))\245\244\224\222RJ\36\24yP\304E\221&"
  "E\330\0A\24.\27\204g\11\213\7\37\4\322\217\36\374A!\375Q\1B%/\27\214a\21\233&"
  ".\134\24*Q\250D\241\22\205J\24*\341\242\11\233&\17J\351\325\203\7%\234\264aC\27.\27"
  "\204g\11\213\7\37\4\322\227\365#\215\36|\20\202\311\32\0D\26.\27\204a\15\223\26\17\36\14\322"
  "\377\217\36|\20\202\311\32\0E\21,\27t\341\17\312\325\335\212\275(Ww\17~F\24,\27t'"
  "\211\212\7\17\324\325\335\212\275(W\377\16\0G\22/\27\224\301\205_\24\255\337\360\225\256\36\374A\1"
  "H\20.\27\204\241\220\376\243\7\177PH\377Q\1I\15)\27\134\341'\205\352\377\223\7\37J\23-"
  "\27|e\37\326\377P\215\66\17\36\264X\242\6\0K#/\27\224\241\224\242\22\205J\24*Q\246H"
  "\231\42\325\24)S\242P\211B%\12=\370\203R\372W\5L\15,\27|\241\134\375\377\357\36\374\0"
  "M\67\63\27\264\301\34\273V^\275y\20\346A\230\7a\36\210x\60\342\301\10\27'T\234PqB"
  "\305\11%E\224\24QRDI\21\65c\324\214Q\63F\315\30E\201\12N\32/\27\224\241\324\242\215"
  "\330p\323\244\23\27.T\214P\341Iox\264\253\2O\17/\27\214\341\37\224\322\377\257\36\374A\1"
  "P\24.\27\204g\11\213\7\37\4\322\77z\360\7%\353%\0Q\26\257\227\213\207I\213\7\37\220\322"
  "\377\257\36\374A\321\262\244\205\7R\36.\27\214g\11\213\7\37\4\322G\17\376\240\10\231\42uS\242"
  "L\211\62%\12iT\0S\26-\27|\341\17\324hX\360\334u\350\256\63\250F\233\7\77PT\15"
  "/\27\214\341_\25\255\377\377\25\0U\15.\27\204\241\220\376\377\217\36\374\1V//\27\214\241\20\33"
  "\66%\314\24)S\244L\221\62E\312\24)S\244\210\221\212J\24*Q\250D\241\22\205J\24*Q"
  "\250D!e\371\15\0WJ\67\27\324\241\24!U\204\24UQ\246P\211\62\205J\224)D\244\214\221"
  "j\214Tr\244\14\221#eJ\34)Sb\4E%FPTbD\242$\250\220\240:\203\352\314\261"
  "\63\307\316\234\63d\316\220\271R\346J\25,U\10\0X\60\61\27\234\243T\21\63f**S\310\204"
  "\251\22\305J\24[\227\60\313\223(\23\246S\267\254D)\23\206L\30*S\306\22\63FJ\225\60e"
  "\0Y&\60\27\224\301\220\211BE\12\25\261\246H\241\42\205X)\323\16!\226F--[\324h\331"
  "\242F\313\26\65\10\0Z\37-\27\204\201\5\213\7\17\322\231+g\256\234\271r\346\312\231+g\231\71"
  "s\345\36\374\240\0[\17\307\267K\341\203\64\364\377\277y\360\240\0\134\32\310\267Sa\324d\222\215\232"
  "\231\260Q\63\223l\324\314$\33\65\63\311F\15]\17\307\267K\341\203\62\364\377\277y\360 \1^\6"
  "\0\20D\1_\10qT\233\341\7\6`\13\246XO\201\14\21\62\203\6a\24.\27\204g\11\213\7"
  "\37\4\322\217\36\374A!\375Q\1b%/\27\214a\21\233&.\134\24*Q\250D\241\22\205J\24"
  "*\341\242\11\233&\17J\351\325\203\7%\234\264ac\27.\27\204g\11\213\7\37\4\322\227\365#\215"
  "\36|\20\202\311\32\0d\26.\27\204a\15\223\26\17\36\14\322\377\217\36|\20\202\311\32\0e\21,"
  "\27t\341\17\312\325\335\212\275(Ww\17~f\24,\27t'\211\212\7\17\324\325\335\212\275(W\377"
  "\16\0g\22/\27\224\301\205_\24\255\337\360\225\256\36\374A\1h\20.\27\204\241\220\376\243\7\177P"
  "H\377Q\1i\13%\27<\341\323\7\177\240\0j\25-\27|\261\276\7V\260\376P\215\66\17\36\264"
  "X\242\6\0k#/\27\224\241\224\242\22\205J\24*Q\246H\231\42\325\24)S\242P\211B%\12"
  "=\370\203R\372W\5l\15,\27|\241\134\375\377\357\36\374\0m\67\63\27\264\301\34\273V^\275y"
  "\20\346A\230\7a\36\210x\60\342\301\10\27'T\234PqB\305\11%E\224\24QRDI\21\65"
  "c\324\214Q\63F\315\30E\201\12n\32/\27\224\241\324\242\215\330p\323\244\23\27.T\214P\341I"
  "ox\264\253\2o\17/\27\214\341\37\224\322\377\257\36\374A\1p\24.\27\204g\11\213\7\37\4\322"
  "\77z\360\7%\353%\0q\26\257\227\213\207I\213\7\37\220\322\377\257\36\374A\321\262\244\205\7r\36"
  ".\27\214g\11\213\7\37\4\322G\17\376\240\10\231\42uS\242L\211\62%\12iT\0s\26-\27"
  "|\341\17\324hX\360\334u\350\256\63\250F\233\7\77Pt\15/\27\214\341_\25\255\377\377\25\0u"
  "\15.\27\204\241\220\376\377\217\36\374\1v//\27\214\241\20\33\66%\314\24)S\244L\221\62E\312"
  "\24)S\244\210\221\212J\24*Q\250D\241\22\205J\24*Q\250D!e\371\15\0wJ\67\27\324"
  "\241\24!U\204\24UQ\246P\211\62\205J\224)D\244\214\221j\214Tr\244\14\221#eJ\34)"
  "Sb\4E%FPTbD\242$\250\220\240:\203\352\314\261\63\307\316\234\63d\316\220\271R\346J"
  "\25,U\10\0x\60\61\27\234\243T\21\63f**S\310\204\251\22\305J\24[\227\60\313\223(\23"
  "\246S\267\254D)\23\206L\30*S\306\22\63FJ\225\60e\0y&\60\27\224\301\220\211BE\12"
  "\25\261\246H\241\42\205X)\323\16!\226F--[\324h\331\242F\313\26\65\10\0z\37-\27\204"
  "\201\5\213\7\17\322\231+g\256\234\271r\346\312\231+g\231\71s\345\36\374\240\0\0\0\0\4\377\377"
  "\0";
#define FRAME_DELAY (0)
#define FRAME_WIDTH (48)
#define FRAME_HEIGHT (48)
#define FRAME_COUNT (sizeof(frames) / sizeof(frames[0]))

// Servo pins
Servo thumbServo;
Servo indexServo;
Servo middleServo;
Servo ringServo;
Servo pinkyServo;

U8G2_SSD1306_128X64_NONAME_F_HW_I2C u8g2(U8G2_R0, /* reset=*/ U8X8_PIN_NONE); // initialization for the used OLED display
/*
  Fontname: Aldo the Apache
  Copyright: 
  Glyphs: 91/256
  BBX Build Mode: 0
*/



bool connectionHindered = true;

// Menu variables
const char *menuItems[] = {"Gesture Control", "Glove Control", "Credits"};
int currentSelection = 0; // Currently selected menu item
const int menuLength = 3;

volatile bool backButtonPressed = false;  // Flag for interrupt


// Define the MAC address of the receiver ESP32 (replace with actual receiver MAC address)
void IRAM_ATTR backButtonInterrupt() {
  // Set flag to true when the back button is pressed
  backButtonPressed = true;
}

// Setup servos
void setupServos() {
  thumbServo.attach(32);
  indexServo.attach(33);
  middleServo.attach(25);
  ringServo.attach(26);
  pinkyServo.attach(27);
}

void loadingAnimation() {
  // Display loading animation
  int frame = 0;
  while (frame<=25){
  display.clearDisplay();
  display.drawBitmap(40, 8, frames[frame], FRAME_WIDTH, FRAME_HEIGHT, 1);
  display.display();
  frame = (frame + 1) % FRAME_COUNT;
  delay(FRAME_DELAY);
  }
}

void setup(void) {
  Serial.begin(115200);
   // Initialize buttons as inputs
  pinMode(BUTTON_UP, INPUT_PULLDOWN);
  pinMode(BUTTON_DOWN, INPUT_PULLDOWN);
  pinMode(BUTTON_SELECT, INPUT_PULLDOWN);
  pinMode(BUTTON_BACK, INPUT_PULLDOWN); // Initialize back button

  display.begin(SSD1306_SWITCHCAPVCC, SCREEN_I2C_ADDR);
  u8g2.begin(); // start the u8g2 library
  u8g2.clearBuffer();		// clear the internal memory
	u8g2.setFont(aldo_the_apache_26pt); // set custom font
  u8g2.drawStr(10,31,"Robotic"); // print some message
  u8g2.drawStr(30,59,"hand"); // print some message
  Serial.begin(115200);
  attachInterrupt(digitalPinToInterrupt(BUTTON_BACK), backButtonInterrupt, FALLING);  // Trigger on falling edge (button press)
  u8g2.sendBuffer();		// transfer internal memory to the display
  delay(2000);  // one second delay, but we are only displaying a static text, so it makes no difference
  WiFi.begin(ssid, password);
  Serial.println("Initializing ESP-NOW...");
 
  // Connect to Wi-Fi
  while (WiFi.status() != WL_CONNECTED) {
    delay(1000);
    Serial.println("Connecting to WiFi...");
  }
  Serial.println("Connected to WiFi");
 // Start UDP
  udp.begin(port);
  Serial.println("UDP server started");

  // Setup servos
  setupServos();
  loadingAnimation();
  if (!display.begin(SSD1306_SWITCHCAPVCC, 0x3C)) {
    Serial.println(F("SSD1306 allocation failed"));
    for (;;)
      ;
  }
  display.clearDisplay();
  display.display();
  drawMenu();
}


void loop() {
  if (backButtonPressed) {
    backButtonPressed = false; // Reset flag
    drawMenu(); // Return to menu
  }

  // Read button states for other menu navigation
  if (digitalRead(BUTTON_UP) == HIGH) {
    currentSelection--;
    if (currentSelection < 0) currentSelection = menuLength - 1;
    drawMenu();
    delay(200); // Debounce delay
  }

  if (digitalRead(BUTTON_DOWN) == HIGH) {
    currentSelection++;
    if (currentSelection >= menuLength) currentSelection = 0;
    drawMenu();
    delay(200); // Debounce delay
  }

  if (digitalRead(BUTTON_SELECT) == HIGH) {
    // Call the function for the selected menu item
    handleSelection(menuItems[currentSelection]);
  }
}


void drawMenu() {
  display.clearDisplay();

  // Draw notification bar
  display.invertDisplay(false);
  display.fillRect(0, 0, SCREEN_WIDTH, 10, SSD1306_WHITE); // Bar background
  display.setTextColor(SSD1306_BLACK);                    // Text color for the bar
  display.setCursor(50, 1);
  display.setTextSize(1);
  display.println(F("Menu"));

  // Draw menu items
  display.setTextColor(SSD1306_WHITE); // Menu text color
  display.setTextSize(1);
  for (int i = 0; i < menuLength; i++) {
    if (i == currentSelection) {
      // Highlight selected menu item
      display.fillRect(0, 12 + i * 16, SCREEN_WIDTH, 16, SSD1306_WHITE);
      display.setTextColor(SSD1306_BLACK);
    } else {
      display.setTextColor(SSD1306_WHITE);
    }
    display.setCursor(5, 14 + i * 16);
    display.println(menuItems[i]);
  }

  display.display();
}

void handleSelection(const char *selection) {
  if (strcmp(selection, "Gesture Control") == 0) {
    // Clear display and show initial message
    display.clearDisplay();
    display.setTextColor(SSD1306_WHITE);
    display.setTextSize(1);
    display.setCursor(15, 15);
    display.println("Connect your");
    display.setCursor(15, 27);
    display.println("laptop...");
    display.display();
    delay(3000);

    display.clearDisplay();
    display.setTextSize(1);
    display.setCursor(10, 20);
    display.println("Listening...");
    display.display();

    // Continuous UDP packet reading
    while (true) {
      int packetSize = udp.parsePacket();
      if (packetSize) {
        // Read incoming packet
        int len = udp.read(incomingPacket, 255);
        if (len > 0) {
          incomingPacket[len] = '\0'; // Null-terminate the string
        }
        Serial.printf("Received: %s\n", incomingPacket);

        // Parse finger status
        int fingerStates[5];
        int index = 0;
        char* token = strtok(incomingPacket, ",");
        while (index < 5 && token != NULL) {
          fingerStates[index++] = atoi(token);
          token = strtok(NULL, ",");
        }

        // Validate and use parsed data
        if (index == 5) {
          Serial.printf("Parsed angles: %d, %d, %d, %d, %d\n", 
                fingerStates[0], fingerStates[1], fingerStates[2], 
                fingerStates[3], fingerStates[4]);
          thumbServo.write(fingerStates[0]);
          indexServo.write(fingerStates[1]);
          middleServo.write(fingerStates[2]);
          ringServo.write(fingerStates[3]);
          pinkyServo.write(fingerStates[4]);
        } else {
          Serial.println("Error: Incomplete data received.");
        }
      }

      // Check if back button is pressed
      if (backButtonPressed) {
        backButtonPressed = false;  // Reset the flag
        drawMenu(); // Return to menu
        return; // Exit the function early
      }

      delay(50); // Small delay to reduce CPU load
    }
  } 
  else if (strcmp(selection, "Glove Control") == 0) {
    display.clearDisplay();
    display.setTextColor(SSD1306_WHITE);
    display.setCursor(30, 30);
    display.println("Coming Soon");
    display.display();
    delay(1000); // Display message for a while
  } 
  else if (strcmp(selection, "Credits") == 0) {
    display.clearDisplay();
    display.setTextColor(SSD1306_WHITE);
    display.setCursor(10, 20);
    display.println("Developed By:");
    display.setCursor(10, 35);
    display.println("Mohd. Abdul Qadir");
    display.display();
    delay(2000); // Display credits for a while
  }
}


void displayNotification(const char *message) {
  display.clearDisplay();
  display.invertDisplay(false);
  // Draw notification background
  display.fillRect(0, 0, SCREEN_WIDTH, SCREEN_HEIGHT, SSD1306_WHITE);

  // Draw notification text
  display.setTextColor(SSD1306_BLACK);
  display.setTextSize(1);
  display.setCursor(10, SCREEN_HEIGHT / 2 - 6);
  display.println(message);
  display.display(); 
}
